üá¨üáß # Vanish ‚Äî How It Works

## Introduction

**Vanish** is a lightweight Windows utility that performs, with a single click, a series of _anti-forensics_ and _privacy-cleanup_ operations. In short, it:

* **Cleans** system logs, caches, temporary files, history entries, and events that could reveal user activity;  
* **Noises** the disk and registry by re-injecting random traces to mask deletions;  
* **Manipulates timestamps**: it rolls the clock back, performs its operations, then restores the original time so newly created artefacts carry inconsistent dates;  
* Presents everything through a **minimal GUI** with two buttons (*Start* and *Exit*) and a progress bar that shows the overall progress.

> ‚ö†Ô∏è  This project is for research and educational purposes **only**.  
> Running Vanish on systems you don‚Äôt own **without explicit consent** may violate laws or ethical guidelines.

---

## 1 ¬∑ Startup & GUI

| Phase          | Details                                                                                                                         |
|----------------|---------------------------------------------------------------------------------------------------------------------------------|
| **wWinMain**   | Registers the window class, creates a **frameless, semi-transparent window** (`WS_POPUP` + layered) sized 350 √ó 450 px, then centers it. |
| **Painting**   | Inside `WM_PAINT` it draws a **vertical grey‚Üíblack gradient** and two hand-drawn **custom buttons** (`Start`, `Exit`) using **AlphaBlend**. |
| **Hit-test**   | In `WM_NCHITTEST` the code decides whether the cursor is over a button (`HTCLIENT`) or elsewhere (window drag).                 |
| **Hover**      | In `WM_MOUSEMOVE` the `hover` flags of the buttons are updated to change color on rollover.                                     |
| **Actions**    | `Start` ‚Üí launches the cleanup sequence; `Exit` ‚Üí `PostQuitMessage(0)`.                                                         |

> **UI note:** the buttons are GDI sprites, not real BUTTON controls; no *.rc resources are required.

---

## 2 ¬∑ ‚ÄúStart‚Äù Sequence (clean & evasion)

The progress bar (`PBS_SMOOTH`) is created in `ShowProgressBar()` and updated in 10-percent steps. Below is the step plan taken directly from `SS.cpp`:

| Step | Percent | Functions called                                                     | What they do                                                                                                                                                                          |
|------|---------|-----------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 1Ô∏è‚É£  | **10 %** | `changeSystemTime`                                                   | Saves the current date/time ‚Üí sets a _random timestamp_ (2015‚Äìtoday).                                                                                                                 |
| 2Ô∏è‚É£  | **20 %** | `discordcache`, `cleandns`, `windef`                                 | Kills Discord, purges its cache & local storage; flushes DNS; deletes Windows Defender logs.                                                                                           |
| 3Ô∏è‚É£  | **40 %** | `cleanevtx`, `cleanregedit`, `cleancron`, `amcache`                  | Cleans Event Logs (System/Application/Security), Explorer MRU, browser history; schedules replacement of **Amcache.hve**.                                                             |
| 4Ô∏è‚É£  | **60 %** | `cleanhistory`, `cleanvarious`, `DPSClean`, `RestartSvc`, `CleanMemory` | Removes PowerShell & RecentDocs history, crash dumps, empties %Temp%; stops telemetry services (DPS, DiagTrack) then restarts them; wipes 100 MB of RAM.                              |
| 5Ô∏è‚É£  | **70 %** | `Journal`, `filestemp`, `Shadows`, `DeleteBam`, `Prefetch`           | Resets the USN Journal, creates/deletes 30 random `.tmp` files, deletes all **Shadow Copies** and the contents of `C:\\Windows\\Prefetch`, clears the **BAM** registry key.           |
| 6Ô∏è‚É£  | **80 %** | ‚Äî                                                                    | (buffer ‚Äî no extra functions; just advances the percentage).                                                                                                                          |
| 7Ô∏è‚É£  | **90 %** | `rsttime`                                                            | Restores the original date/time saved at step 1Ô∏è‚É£.                                                                                                                                    |
| 8Ô∏è‚É£  | **100 %**| `POPJournal`, `Events`, `security`                                   | Re-populates the USN Journal and Temp with random files, **overwrites** the Event Logs with 10 000 ‚Äúplausible‚Äù entries, spawns 10 000 minimized `taskhostw.exe` processes as noise.   |
| ‚Äî    | **End** | `HideProgressBar`, `PostQuitMessage(0)`                               | Hides the bar ‚Üí application terminates.                                                                                                                                               |

> **Why this order?**  
> ‚Ä¢ The clock is skewed **before** generating artefacts ‚Üí timestamps become inconsistent.  
> ‚Ä¢ Data is first wiped, then overwritten with random ‚Äúnoise‚Äù.  
> ‚Ä¢ The clock is restored **after** cleanup to avoid obvious traces.

---

## 3 ¬∑ Key Files

| File         | Role                                               | Note |
|--------------|----------------------------------------------------|------|
| `SS.cpp`     | Entry point + GUI + orchestration of all steps.    | |
| `funzioni.h` | Toolbox with ~40 cleanup, spoofing, and noise routines for logs/registry/disk. | |
| `classi.h`   | `menu` struct, `WriteCallBack` for potential HTTP requests (currently unused in `SS.cpp`). | |

---

## 4 ¬∑ Requirements

| Item            | Why?                                                                                                                   |
|-----------------|------------------------------------------------------------------------------------------------------------------------|
| **PowerShell 7**| Used for multi-threading and scripted tasks.                                                                           |
| **Privileges**  | The cleaner modifies registry keys under `HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\bam\\State\\UserSettings\\‚Ä¶`; run elevated. |

---

## 5 ¬∑ Quick Build

```bash
vcpkg install --triplet x64-windows
cl /std:c++17 /EHsc SS.cpp user32.lib gdi32.lib comctl32.lib msimg32.lib dwmapi.lib
```

üáÆüáπ # Vanish ‚Äî Come funziona

## Introduzione

**Vanish** √® una piccola utility Windows pensata per eseguire, con un solo click, una serie di operazioni di _anti-forensics_ e _privacy cleanup_. In pratica:

* **Pulisce** log di sistema, cache, file temporanei, cronologia ed eventi che potrebbero rivelare l‚Äôattivit√† dell‚Äôutente;  
* **Sporca** (‚Äúnoise‚Äù) il disco e i registri reinserendo tracce casuali per mascherare le cancellazioni;  
* **Manipola i timestamp**: porta indietro l‚Äôorologio, compie le operazioni, poi ripristina l‚Äôora originale cos√¨ che i nuovi artefatti abbiano date incoerenti;  
* Il tutto √® presentato in una **GUI minimale** con due pulsanti (*Start* e *Exit*) e una progress-bar che indica l‚Äôavanzamento.

> ‚ö†Ô∏è  L‚Äôobiettivo √® puramente didattico/di ricerca.  
> Usare Vanish su macchine di terzi **senza consenso** pu√≤ costituire violazione di legge.

---

## 1 ¬∑ Avvio & GUI

| Fase           | Dettagli                                                                                                             |
|----------------|----------------------------------------------------------------------------------------------------------------------|
| **wWinMain**   | Registra la classe finestra, crea una **finestra frameless & semi-trasparente** (`WS_POPUP` + layered) di 350√ó450 px, poi la centra sul monitor. |
| **Disegno**    | In `WM_PAINT` viene ridisegnato un **gradiente verticale grigio‚Üínero** e due _custom buttons_ disegnati a mano con **AlphaBlend** (`Start`, `Exit`). |
| **Hit-test**   | In `WM_NCHITTEST` il codice decide se il cursore √® sui pulsanti (allora restituisce `HTCLIENT`) o altrove (trascinamento finestra). |
| **Hover**      | In `WM_MOUSEMOVE` i flag `hover` dei bottoni vengono aggiornati per cambiare colore.                                 |
| **Azioni**     | `Start` ‚Üí avvia la sequenza di pulizia; `Exit` ‚Üí `PostQuitMessage(0)`                                                |

> **Nota UI**: i bottoni non sono veri controlli BUTTON; sono sprite GDI. Nessuna dipendenza da resource *.rc.

---

## 2 ¬∑ Sequenza ‚ÄúStart‚Äù (clean & evasion)

La progress-bar (`PBS_SMOOTH`) nasce in `ShowProgressBar()` e viene aggiornata in blocchi di 10 punti. Sotto, lo _step plan_ preso direttamente da `SS.cpp`:

| Ordine | Percentuale | Funzioni chiamate                                                     | Cosa fanno                                                                                                                                                                                      |
|--------|-------------|-----------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 1Ô∏è‚É£      | **10 %**    | `changeSystemTime`                                                   | Salva data/ora correnti ‚Üí imposta _timestamp casuale_ (2015‚Äìoggi).                                                                                                                              |
| 2Ô∏è‚É£      | **20 %**    | `discordcache`, `cleandns`, `windef`                                 | Kill Discord, svuota cache & Local Storage; flush DNS; cancella log di Windows Defender.                                                                                                        |
| 3Ô∏è‚É£      | **40 %**    | `cleanevtx`, `cleanregedit`, `cleancron`, `amcache`                 | Pulisce Event Log (System/Application/Security), MRU di Explorer, cronologia browser, programma la sostituzione di **Amcache.hve**.                                                             |
| 4Ô∏è‚É£      | **60 %**    | `cleanhistory`, `cleanvarious`, `DPSClean`, `RestartSvc`, `CleanMemory` | Rimuove history di PowerShell & RecentDocs, crash dumps, svuota %Temp%, stoppa servizi telemetria (DPS, DiagTrack) poi li riavvia; _wipe_ di 100 MB RAM.                                        |
| 5Ô∏è‚É£      | **70 %**    | `Journal`, `filestemp`, `Shadows`, `DeleteBam`, `Prefetch`           | Resetta USN Journal, crea/elimina 30 file .tmp random, cancella tutti i **Shadow Copy** e il contenuto di `C:\\Windows\\Prefetch`, azzera la chiave **BAM**.                                     |
| 6Ô∏è‚É£      | **80 %**    | ‚Äî                                                                    | (buffer ‚Äî nessuna funzione extra; percentuale solo progressiva).                                                                                                                                |
| 7Ô∏è‚É£      | **90 %**    | `rsttime`                                                            | Ripristina la data/ora originali salvate al passo 1Ô∏è‚É£.                                                                                                                                            |
| 8Ô∏è‚É£      | **100 %**   | `POPJournal`, `Events`, `security`                                   | Popola USN e cartella Temp con file random, _sovrascrive_ i registri EventLog con 10 000 voci ‚Äúplausibili‚Äù, avvia 10 000 processi `taskhostw.exe` minimizzati per rumorosit√†.                    |
| ‚Äî      | **Fine**    | `HideProgressBar`, `PostQuitMessage(0)`                              | Barra sparisce ‚Üí l‚Äôapp termina.                                                                                                                                                                 |

> **Perch√© questo ordine?**  
> ‚Ä¢ Si altera l‚Äôora **prima** di produrre artefatti ‚Üí tutti i timestamp diventano incoerenti.  
> ‚Ä¢ Si pulisce, poi si riscrive con eventi casuali (‚Äúnoise‚Äù).  
> ‚Ä¢ Si ripristina l‚Äôorario **dopo** la pulizia per non lasciare tracce evidenti.

---

## 3 ¬∑ File principali

| File          | Ruolo                                                         | Nota |
|---------------|--------------------------------------------------------------|------|
| `SS.cpp`      | _Entry point_ + GUI + orchestrazione di tutti gli step.       | |
| `funzioni.h`  | Toolbox con ~40 routine di pulizia, spoofing e noise su log/reg/hdd. | |
| `classi.h`    | Struct `menu`, callback `WriteCallBack` per eventuali richieste HTTP (non ancora usato in `SS.cpp`). | |

---

## 4 ¬∑ Requisiti

| Cosa          | Perch√®?                                                      |
|---------------|--------------------------------------------------------------|
| `Powershell 7`| per un avere l'utilizzo del multi-threading. |
| `Privilegi`   | il Cleaner cambia delle regedit riguardanti la bam impostate i privilegi su HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\bam\State\UserSettings\S-1-5-21-4006182184-4220401772-2549539988-1001 |

---

## 5 ¬∑ Compilazione rapida

```bash
vcpkg install --triplet x64-windows
cl /std:c++17 /EHsc SS.cpp user32.lib gdi32.lib comctl32.lib msimg32.lib dwmapi.lib
```
